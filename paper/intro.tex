\section{Introduction}
\label{section:intro}

% Motivation and context
%-----------------------

%   - The need for better stellar ages.
The formation and evolution of the Milky Way (MW) and the planetary systems
within it are two topics of significant interest in astronomy today.
Both of these fields require precise and accurate ages of tens to hundreds of
thousands of stars.
Precise ages of red giant stars, some calculated from asteroseismology, some
from spectroscopy, some from physical models and some from machine learning
methods have recently been used to explore the age distributions of stellar
populations in the MW \citep[\eg][]{ness2015, stello2017, das2018,
sanders2018}.
Red giants are highly luminous and can be observed to great distances, thus
providing age information on the scale of tens of kilo-parsecs.
Main sequence (MS) stars on the other hand, although fainter, are more
numerous and so their ages may provide new insights into the formation and
evolution of the Solar neighborhood.
MS star ages are also of great interest for studying the formation and
evolution of planetary systems.
Almost all exoplanets discovered to date orbit MS stars and it is therefore
{\it MS star} ages that are needed to study planet evolution.
Unfortunately, the very property that makes MS stars good hosts for habitable
planets also makes them difficult to date: they do not change substantially
over time.
% There are several properties of giant stars that make them easier to date than
% MS stars.
% One property is that their acoustic oscillations have long periods of hours to
% days and large amplitudes, so they can be detected and resolved using the
% \kepler\ spacecraft's long cadence mode.
% The acoustic modes of MS stars, on the other hand, have typical periods of
% five minutes, which are unresolvable in \kepler's long cadence mode (thirty
% minutes between observations).
% The large numbers of giants with asteroseismic ages \citep[\eg][]{huber2010,
% yu2016, stello2017, yu2018, de_assis_peralta2018} provides a large training
% set for machine learning methods.
% In addition the ages of red giants are strongly correlated with their masses,
% so if mass can be measured (from the spectrum, for example), so can age
% \citep{ness2015}.

% Age is the most elusive fundamental stellar property and is extremely
% difficult to measure for field stars -- especially cool stars on the MS.
% However, a time axis is essential for studying the evolution and formation of
% any astronomical object, from a planetary system to the Milky Way itself, so
% improvements in stellar age-dating methods would have a wide-reaching impact
% across astronomy.
% For example, in the field of exoplanets the ages of planet hosting stars could
% be used to explore the dynamical and architectural evolution of planetary
% systems.
% % The typical timescales for planetary system stability could be inferred,
% % leading to implications for the fates of planetary systems in the Milky Way
% % including our own.
% New stellar ages would also benefit galactic archaeologists and could resolve
% the mystery behind the formation of the galactic thin disk.
% {\bf The need for more precise and accurate stellar ages is virtually
% universal within astronomy.}

The difficulty of age-dating is particularly acute for low mass (GKM) stars on
the MS: precisely those that comprise the majority of known planet hosts.
Using conventional dating methods, uncertainties on the ages of these stars
can be as large as the age of the Universe, \ie\ they are completely
unconstrained.
% , and
% ages precise to within 50\% are considered `ultra-precise'
% \citep{soderblom2010}.
The stars eligible for {\it truly} precise age-dating, where age uncertainties
can be as low as 10\%, are those in nearby open clusters, those with
observable acoustic oscillations (asteroseismic stars), those just turning off
the MS, and the Sun
\citep[see][for a review of stellar ages]{soderblom2010}.
There are only a few tens of cool, MS stars with precise ages that are
suitable for exoplanet population studies, however {\it tens-of-thousands} of
precise ages are needed to study the evolution of planetary systems.
The number of planets detected in open clusters, therefore with precise ages,
is growing, however there are still only a couple of dozen of these discovered
so far and the total number of detectable planets in clusters is unlikely to
reach statistical numbers in the near future, if ever.
In order to study the evolution of planetary systems, a significant number of
precise ages for cool MS {\it field} stars are needed.
Neither cluster stars nor asteroseismic stars can currently provide the
numbers required for exoplanet population studies: age-dating methods for cool
MS field stars {\it must} be improved before the evolution of planets can be
explored.

% Planetary system studies are one example of an astronomical field that would
% greatly benefit from a large stellar age catalog.
% Another notable field that requires large numbers of stellar ages is galactic
% archaeology.
% Machine learning methods have significantly improved age-dating for field red
% giant stars recently, and large-scale catalogs of precise giant ages have lead
% to dramatic breakthroughs in galactic archaeology \citep[\eg][]{ness2015,
% das2018, sanders2018}, but these methods are not yet applicable to MS stars,
% yet MS stars are more numerous than red giants and their ages could
% revolutionize galactic archaeology.
% The largest catalog of precise ages for field {\it MS} stars currently
% available is the short-cadence Kepler asteroseismic catalog of 500 stars
% \citep{chaplin2014}.
% However, few of these stars are truly on the MS (most are on the subgiant
% branch) and even fewer are cool -- most being A, F and G types.
% There is currently {\it no} large catalog of stellar ages for field MS stars,
% and there is unlikely to be one until after the launch of {\it PLATO} and the
% release of a large catalog of asteroseismic properties.

%   - Why are MS ages harder than red giant ages?
% Unlike red giants, the masses of MS stars are not strongly correlated with
% age, so mass cannot be used as an age proxy.
The spectra and colors of MS stars do not contain a significant amount of age
information because they do not change rapidly.
This is represented in the spacing of isochrones on a Hertsprung-Russell (HR)
or color-magnitude diagram (CMD).
On the MS, isochrones are tightly spaced and, even with very precise
measurements of effective temperature and luminosity, the position of a MS
star on the HR diagram may be consistent with range of isochrones spanning
several billion years.
At main sequence turn-off however, isochrones are spread further apart, so
that sufficiently precisely measured temperatures and luminosities may yield
ages that are extremely precise.
% Typical age uncertainties of dwarfs.
The classical method for measuring stellar ages is isochrone placement, or
isochrone fitting, where surface gravity changes resulting from fusion in the
core (usually observed via luminosity, $L$, and effective temperature, \teff,
or absolute magnitude and colour) are compared with a set of models that trace
stellar evolution across the Hertzprung-Russell, or color-magnitude diagram
(CMD).
Surface gravity changes have been thoroughly mapped with physical models, and
can be used to calculate relatively accurate (but not necessarily precise)
ages, barring some small, $\sim$10\% variations between different models.
Isochronal ages {\it can} be precise for stars turning off the MS, because the
rate of change in brightness and temperature is large during this phase of
stellar evolution.
However, on the MS itself, there is little differentiation between stars of
different ages in the $L$ and \teff\ plane, so ages tend to be very imprecise.
Gyrochronology, the method of inferring a star's age from its rotation period
is much better suited to measuring ages on the MS.

\begin{figure}
  \caption{
    This figure shows Solar-metallicity MIST isochrones in \Gaia\ absolute
    G-band magnitude and Gaia $G_{BP} - G_{RP}$ color.
    In the left panel the isochrones are colored by the minimum absolute age
    uncertainty at each point on the CMD, calculated using the Fisher
    information, based on the typical uncertainties of \Gaia\ photometry
    (represented by black errorbars in the upper right).
    The purple color in the top left corresponds to small age uncertainties,
    \ie\ good age precision.
    Age precision increases as stars begin to turn off the MS.
    On the MS however, particularly at low masses, the age precision is poor.
    For late K dwarfs, for example, isochrone fitting age uncertainties exceed
    the age of the Universe.
    This makes sense when you consider that typical \Gaia\ uncertaintes on $G$
    and $G_{BP} - G_{RP}$ exceed the entire width of the MS, which spans
    0.01-14 Gyrs.
    Isochrone fitting is not an appropriate age-dating method for MS stars,
    especially at low masses.
    In the right panel the isochrones are colored by the logarithmic
    {\it relative} age precision at each point in the CMD.
    Relative age uncertainties range from 100\% for the oldest MS GKM stars,
    to several thousand percent for the youngest.
    These age uncertainties were calculated using the derivatives of $G$ and
    $G_{BP} - G_{RP}$ with age, \ie\ the rate of change in a star's luminosity
    and temperature.
    For example, K dwarf temperatures increase at a rate of only around 20 K
    per billion years.
    The precision with which an age can be measured is related to the
    separation between isochrones, which indicate epochs of rapid change
    (steep gradients).\label{fig:fischer_iso}
}
  \centering
    \includegraphics[width=1\textwidth]{iso_fisher_temp.png}
\label{fig:iso_fisher}
\end{figure}

\begin{figure}
  \caption{
    As figure \ref{fig:iso_fisher}, however in this case the minimum age
    uncertainties are calculated based on isochrone fitting and gyrochronology
    {\it combined}.
    The isochrones are colored by the minimum relative age uncertainty at each
    point on the CMD, based on the typical uncertainties of Gaia photometry
    and Kepler rotation period uncertainties (assumed to be around 1 day).
    In contrast to figure \ref{fig:iso_fisher}, here the left panel shows the
    {\it logarithmic} absolute age and the right panel shows the linear
    relative age.
    The isochrones still supply precise ages at the MS turn off (purple, upper
    left) however, gyrochronology supplies precise ages on the MS (15 - 25\%
    relative precision).
    Gyrochronology and isochrone fitting complement each other and when used
    together, all subgiants and MS stars can have ages more precise than 30\%.
    \label{fig:fischer_gyro}
}
  \centering
    \includegraphics[width=1\textwidth]{gyro_fisher_temp.png}
\label{fig:gyro_fisher}
\end{figure}

The gyrochronology model used to calculate the Fisher information is a simple
polynomial model, fit to Praesepe and the Sun only.
The minimum theoretical absolute age uncertainty (left panel) ranges from tens
of millions to a few billion years (up to around 3 Gyr for old G dwarfs).
This is the minimum theoretical precision given the adopted gyrochronology
model and, since the model used for this calculation does not include
intrinsic scatter which is particularly large for young stars, the minimum age
uncertainty for young stars is over-optimistic.
Similarly, our model does not account for weakened magnetic braking at old
ages \citep{vansaders2016} so is also optimistic for old dwarfs.

Asteroseismology can provide precise ages of {\it both} red giant and MS stars
but due to the greater quantity of observations suitable for {\it red giant}
asteroseismology, precise red giant asteroseismic ages outnumber MS ages.
% The frequencies of acoustic pulsations reveal the densities of stars, and,
% as
% those densities are age-dependent, can provide precise stellar age
% measurements.
% \kepler, a high-precision space-based photometric survey produces light curves
% of stars that are sometimes precise enough to detect brightness fluctuations
% caused by these acoustic pulsations.
The typical periods of red giant acoustic pulsations are long (on the orders
of hours to weeks) and can be detected using \kepler's long cadence mode of
one observation per thirty minutes, \kepler's standard and most common
observing mode.
In addition, the amplitudes of red giant pulsations are typically very large,
significantly greater than \kepler's photometric noise floor.
MS stars, on the other hand, oscillate with periods of just a few minutes and
the long cadence \kepler\ observations, taken once every half-hour, are
far above the Nyquist limit and not capable of resolving these pulsations.
Asteroseismic measurements of MS stars can only be made when observed in
\kepler's short cadence mode of one observation every minute.
% Around two thousand stars were observed in short cadence mode during \kepler's
% original mission.
However, since the amplitude of pulsation scales with stellar radius, the
majority of stars with asteroseismic ages successfully measured using \kepler\
short-cadence observations, of which there are currently around 500
\citep{chaplin2014}, are subgiants.
Only $\sim$30 of these are truly on the MS.
This may change soon however: \kepler's short cadence
light curves have recently been reprocessed and new, precise ages for the {\it
all} stars observed in short cadence mode (around 2000 in the original
\kepler\ mission) may be measured and made available soon.

%   - Introduce gyrochronology
% A star like the Sun will increase in luminosity by only around a factor of two
% before turning off the MS.
% In addition, the Sun's temperature will only increase by around 100 K during
% its $\sim$8 billion year MS lifetime.
The Sun's rotation period will vary by almost an order of magnitude over its
MS lifetime due to magnetic braking.
In contrast, luminosity and temperature are not sensitive age proxies for
Sun-like stars, are often inferred indirectly, and can be difficult to infer
precisely.
In addition, the precision with which the luminosity and temperature of a star
can be measured is highly sensitive to its distance and the amount of
extincting dust along the line of sight.
Stellar rotation periods are much more sensitive to age than luminosity or
temperature and can be measured precisely, with little dependence on distance
and none on extinction, directly from \kepler\ light curves.
% Incorporating rotation period measurements into isochrone fitting methods
% provides additional information that allows for much more precise age
% inference.
Gyrochronology, the dating method that uses stellar rotation periods, has the
potential to provide MS star ages that are precise to around 20\%
\citep{epstein2014}.
Due to the abundance of rotation periods of MS stars already provided by
\kepler/\ktwo\ and the many more expected from future photometric surveys,
gyrochronology is one of the most readily available methods for inferring
precise stellar ages and, as such, has gained interest over the last few
years.

%   - How does gyrochronology work?
Magnetic braking in MS stars was first observed by \citet{Skumanich1972} who,
studying young clusters and the Sun, found that the rotation periods of
Solar-type stars decay with the square-root of time.
It has since been established that the rotation period of a star depends, to
first order, only on its age and mass \citep[\eg][]{barnes2003}.
This means that by measuring a star's rotation period and a suitable mass
proxy (B-V color is commonly used), one can determine its age.
The convenient characteristic of stars that allows their ages to be inferred
from their {\it current} rotation periods and independently of their
primordial ones, comes from the steep dependence of spin-down rate on rotation
period \citep{kawaler1989}.
% Observations of young clusters indicate that stellar angular momentum loss
% rate is proportional to the cube of the angular velocity.
This means that a star spinning with high angular velocity will experience a
much greater angular momentum loss rate than a slowly spinning star.
For this reason, no matter the initial rotation period of a Sun-like star,
after around 500 million years stellar rotation periods appear to converge
onto a tight sequence \racomment{citation}.
After this time, the age of a star can be inferred, to first order, from its
mass and rotation period alone; this is the principle behind gyrochronology.

% % Explain the project (add more detail here.)
% In this work we present and test a new age-dating model that combines stellar
% evolution models with an empirical gyrochronology model in a Bayesian
% framework.
% This approach has an advantage over either isochrone fitting or gyrochronology
% alone since the addition of age-relevant information will always improve
% stellar age estimates, unless the models are wrong.

%   - Theoretical vs empirical gyro models
The relation between age, rotation period and mass has been studied in detail,
and several different models have been developed to capture the rotational
evolution of Sun-like stars.
Some of these models are theoretical and based on physical processes; modeling
angular momentum loss as a function of the stellar properties as well as the
properties of the magnetic field and stellar wind \citep{kawaler1988,
kawaler1989, vansaders2013, matt2015, vansaders2016}.
Other models are empirical and capture the behavior of stars from a purely
observational standpoint, using simple functional forms that can reproduce the
data \citep{barnes2003, barnes2007, mamajek2008, angus2015}.
Both types of model, theoretical and empirical, must be calibrated using
observations.
% Even the theoretical models are highly sensitive to some stellar properties
% that are not measurable: mass-loss rate and magnetic field geometry, for
% example.
Old calibrators are especially important because new evidence suggests that
rotational evolution goes through a transition at old age or, more
specifically, at a large Rossby number, $Ro$ (the ratio of rotation period to
the convective overturn timescale).
For example, old \kepler\ asteroseismic stars rotate more rapidly than
expected given their age \citep[\eg][]{angus2015, vansaders2016}.
A new physically motivated gyrochronology model, capable of reproducing these
data, was recently introduced \citep{vansaders2016}.
It relaxes magnetic breaking at a critical Rossby number of around the Solar
value, 2.1.
This model predicts that, after stellar rotation periods lengthen enough to
move stars cross this $Ro$ threshold, stars stop spinning down and maintain a
constant rotation period from then until they evolve off the MS.
The implication is that the ages of stars with $Ro >$ 2.1 cannot be measured
from their rotation periods.
Despite recent advances in rotation-dating, such as the new $Ro$ transition
models \citep{vansaders2016, vansaders2018}, there is still substantial room
for improvement in the gyrochronology relations.

% %   - Motivation for improvements to gyrochronology relations
% % For example, there is, as yet no {\it fully} empirical gyrochronology model
% % that includes a weakened magnetic braking law after the $Ro$ = 2.1 transition.
% Empirical models have value as they are often more flexible than physical
% models and can capture trends in the data before the physical processes at
% work are fully understood.
% In addition, no single gyrochronology relation can reproduce the rotational
% behaviour of all open clusters; the relation between rotation period, age and
% mass varies from cluster to cluster in a way that cannot be captured by
% any current model.
% Again, this is related to the issue of model flexibility.
% Finally, more stars with precisely measured old ages are needed to confidently
% calibrate gyrochronology models at old ages.
% New asteroseismic calibrators will become available from reprocessed \kepler\
% short cadence light curves, however significant numbers of suitable
% gyrochronology calibrators may not be accessible until after the European
% Space Agency's \plato\ mission is launched.

%   - Describe the project presented here.
The gyrochronology models that capture post $Ro$-threshold, rotational
evolution \citep{vansaders2016} are the current state-of-the-art in rotation
dating.
% developed and calibrated in \citet{epstein2014, vansaders2015,
% vansaders2016, vansaders2018} However, despite their superior accuracy, they
These models are expensive to compute and, just as with most isochrones and
stellar evolution tracks, are usually pre-computed over a grid of stellar
parameters, then interpolation is used to predict the age of a star.
The process of measuring a stellar age with these models is similar to
inferring an age using any set of isochrones, with the main difference being
that rotation period is an additional dimension.
Ages calculated using these models are therefore likely to be much more
precise than using rotation-free isochrones since rotation period provides an
additional anchor-point for the age of a star.
% In order to infer an age from these models, one would effectively perform
% isochrone fitting but in this case, rotation period would be added as an
% additional parameter and the ages inferred would therefore be more precise and
% accurate.
We present here a complementary method that combines isochrones with an {\it
empirical} gyrochronology model using a Bayesian framework.
The methodology is related to the models described above \citep{vansaders2016}
in that both use a combination of rotation periods and other observable
properties that track stellar evolution on the HR diagram in concert.
The main difference is that the gyrochronology model used here is an entirely
empirically calibrated one, as opposed to a physically derived one.
One major advantage of using a physically motivated gyrochronology model over
an empirically calibrated one is the ability to rely on physics to interpolate
or extrapolate over parts of parameter space with sparse data coverage.
However, rotational spin-down is a complex process that is not yet fully
understood and currently no physical model can accurately reproduce all the
data available.
For this reason, even physically motivated gyrochronology models cannot always
be used to reliably extrapolate into unexplored parameter space.
Physical models, when calibrated to data can provide insight into the physics
of stars however, if accurate and precise {\it prediction} of stellar
properties is desired, empirical models can have advantages over physical
ones.
For example, the data may reveal complex trends that cannot be reproduced with
our current understanding of the physical processes involved but may be
captured by more flexible data-driven models.
In addition, it is relatively straightforward to build an element of
stochasticity into empirical models, \ie\ to allow for and incorporate
outliers or noisy trends.
This may be particularly important for stellar spin down, which does not
always seem to behave predictably.
% For example, synchronized binaries often appear to be rapidly rotating single
% stars which do not fall on the gyrochronology sequence and are perhaps one of
% the most common cause of outliers.
% One can never be certain that the rotation period of any given star truly
% reflects its age: there is a chance that it is an outlier.
% The probability that a star is an outlier in rotation-color-age space can be
% modeled and incorporated easily into an empirical gyrochronology model.
% In a deterministic model, a star with a rotation period that misrepresents its
% age will have a precise but extremely inaccurate inferred age.
% If however, some allowance for outliers or instrinsic scatter is built into
% the models, such a star would be recognized as an outlier and would have a
% very imprecise but accurate inferred age.
% The relation between rotation period and age for M dwarfs is noisy, and a
% deterministic model would not be appropriate for these stars: it would lead to
% inaccurately predicted ages with over-optimistic precision.
% Instead, these data could be appropriately modeled with a stochastic mixture
% of broad Gaussians, or similar.
A further advantage of empirical models is that inference is more tractable:
it can be extremely fast to fit them to data.
We use a simple, empirical, deterministic gyrochronology model in this work,
which, like any other gyrochronology model, cannot yet reproduce all the
observed data.
Simple modifications could be made to this model to produce
significant improvements, for example, by including instrinsic scatter and
outliers, however we leave these improvements for a future project.
% For example, an allowance for outliers; stars with anomalously fast or slow
% rotation periods, could be build into our model.
Ultimately, the model we present here will provide a baseline against which
more physically motivated models can be compared.

Despite significant advances in both theoretical and empirical gyrochronology
models, no existing model is currently able to reproduce the data.
% theoretical models of stellar spin-down as well as new calibrations of
% empirical models, the gyrochronology relations have not yet been finalized
% because
New high quality rotation periods recently measured from Kepler/K2
observations reveal that rotational evolution is more complicated than
previously thought, partly because the shape of the rotation-color relation is
different and unique for each cluster \citep{meibom2011, meibom2015,
rebull2016, douglas2016, rebull2017, douglas2017} and partly because stars
appear to stop spinning down at old ages \citep{angus2015, vansaders2016,
vansaders2018}.
Theoretical models have been developed to reproduce the lack of magnetic
braking at old ages \citep{vansaders2016, vansaders2018}, however no model has
yet been designed to fit the individual shape of every cluster.
In addition, the relation between rotation period, color and age appears to be
stochastic at all ages and masses, particularly for young and low-mass
stars.
The gyrochronology relations could be improved in three main ways.
Firstly,
because stellar evolution is a noisy process that produces outliers and
scatter, gyrochronology models could be non-deterministic.
Secondly, the gyrochronology models could be more flexible in order to
capture the inter-cluster variation in the shape of the rotation-color
relations.
Finally, new calibrators are needed to more precisely constrain rotational
evolution at low masses and old ages.
 % for two main reasons.
% Firstly, the rotational evolution of stars is complex and not well understood.
% It is difficult to reproduce the trends in the data using the known physical
% processes acting within stellar interiors, surfaces and winds.
% It is also challenging to come up with an empirical model that is flexible
% enough to capture trends in the data.
% Secondly, there is a lack of suitable calibration stars with precisely
% measured ages, particularly at old ages.  % and low masses.
% % These regions of parameter space are especially important because some
% % evidence suggests that rotational evolution goes through a transition at old
% % ages and low masses.
% % This region of parameter space is especially important because new evidence
% % This region of parameter space is

% % Inconsistency and inaccuracy of models
% In addition to the difficulties imposed by the slow timescale for change
% within MS stars that results in poor age precision, different dating methods
% often produce inconsistent predictions for the age of a star as a result of
% model inaccuracies.
% For example, an asteroseismic age will not necessarily agree with a isochronal
% one and even isochronal ages derived from different stellar evolution models
% can be inconsistent.
% % physics driving models are wrong.
% % Not enough calibration data.
% This problem arises from a lack of calibrators with sufficiently precise
% stellar properties.

% Bayesian isochrone fitting.
% This section should contain more background about the poor uncertainties
% expected when a purely isochrone fitting technique is used.

% Sum up.
%-----------------------------------------------------------------------------
% There is still some way to go before the models we use to age-date
% MS stars produce precise and accurate ages.
% This paper presents an incremental step toward improving age-dating models and
% best-practises.
% It also provides a discussion on the balance between accuracy and precision
% within age-dating models.

% Paper outline
%-----------------------------------------------------------------------------
This paper is laid out as follows.
In section \ref{section:method} we describe our new age-dating model and its
implementation, in section \ref{section:results} we test this model on
simulated stars, cluster stars and asteroseismic stars, and in section
\ref{section:discussion} we discuss the implications of these tests and future
pathways for development.
Throughout this paper we use the word {\it `observables'} to describe the set
of \teff, \logg, observed bulk metallicity, parallax, photometric color and
rotation period observations for a given star.
We use the word {\it `parameters'} to refer to the physical properties of that
star: age, mass, true bulk metallicity, distance and V-band extinction that
{\it generate} the observables.
