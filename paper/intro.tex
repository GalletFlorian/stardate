\section{Introduction}
\label{section:intro}

% Motivation and context
%-----------------------

%   - The need for better stellar ages.
The formation and evolution of the Milky Way (MW) and the planetary systems
within it are two topics of significant interest in astronomy today.
Both of these fields require precise and accurate ages of tens to hundreds of
thousands of stars.
Precise ages of red giant stars, some calculated from asteroseismology and
some from spectroscopy have recently been used to explore the age
distributions of stellar populations in the MW
\racomment{\citep[\eg][]{citation}}.
Red giants are highly luminous and can be observed to great distances, thus
providing age information on the scale of tens of kilo-parsecs.
Main sequence (MS) stars on the other hand, although fainter, are more
numerous and so their ages may provide new insights into the formation and
evolution of the Solar neighborhood.
MS star ages are also of great interest for studying the formation and
evolution of planetary systems.
Almost all exoplanets discovered to date orbit MS stars and it is therefore
{\it MS star} ages that are needed to study planet evolution.
Unfortunately, the very property that makes MS stars good hosts for habitable
planets also makes them difficult to date: they do not change substantially
over time.

%   - Why are MS ages harder than red giant ages?
Unlike the spectra and photometric colors of red giants, MS star spectra and
colors do not contain a significant amount of age information because they do
not change rapidly.
This is represented in the spacing of isochrones on a Hertsprung-Russell (HR)
or color-magnitude diagram (CMD).
On the MS, isochrones are tightly spaced and, even with very precise
measurements of effective temperature and luminosity, the position of a MS
star on the HR diagram may be consistent with range of isochrones spanning
several billion years.
On the giant branch however, isochrones are spread further apart, so that
sufficiently precisely measured temperatures and luminosities may yield ages
that are precise to within 20\% or better.
% Typical age uncertainties of dwarfs.
\racomment{Look at typical age uncertainties from APOGEE.} Asteroseismology
can provide precise ages of {\it both} red giant and MS stars but due to the
greater quantity of observations suitable for {\it red giant}
asteroseismology, precise red giant asteroseismic ages outnumber MS ages.
% The frequencies of acoustic pulsations reveal the densities of stars, and,
% as
% those densities are age-dependent, can provide precise stellar age
% measurements.
% \kepler, a high-precision space-based photometric survey produces light curves
% of stars that are sometimes precise enough to detect brightness fluctuations
% caused by these acoustic pulsations.
The typical periods of red giant acoustic pulsations are long (on the orders
of hours to weeks) and can be detected using \kepler's long cadence mode of
one observation per thirty minutes, \kepler's standard and most common
observing mode.
In addition, the amplitudes of red giant pulsations are typically very large,
significantly greater than \kepler's photometric noise floor.
MS stars, on the other hand, oscillate with periods of just a few minutes and
the long cadence \kepler\ observations, taken once every half-hour, are
far above the Nyquist limit and not capable of resolving these pulsations.
Asteroseismic measurements of MS stars can only be made when observed in
\kepler's short cadence mode of one observation every minute.
% Around two thousand stars were observed in short cadence mode during \kepler's
% original mission.
However, since the amplitude of pulsation scales with stellar radius, the
majority of stars with asteroseismic ages successfully measured using \kepler\
short-cadence observations, of which there are currently around 500
\citep{chaplin2014}, are subgiants.
Only $\sim$30 of these are truly on the MS.
This may change soon however: \kepler's short cadence
light curves have recently been reprocessed and new, precise ages for the {\it
all} stars observed in short cadence mode (around 2000 in the original
\kepler\ mission) may be measured and made available soon.

%   - Introduce gyrochronology
% A star like the Sun will increase in luminosity by only around a factor of two
% before turning off the MS.
% In addition, the Sun's temperature will only increase by around 100 K during
% its $\sim$8 billion year MS lifetime.
The Sun's rotation period will vary by almost an order of magnitude over its
MS lifetime due to magnetic braking.
In contrast, luminosity and temperature are not sensitive age proxies for
Sun-like stars, are often inferred indirectly, and can be difficult to infer
precisely.
In addition, the precision with which the luminosity and temperature of a star
can be measured is highly sensitive to its distance and the amount of
extincting dust along the line of sight.
Stellar rotation periods are much more sensitive to age than luminosity or
temperature and can be measured precisely, with little dependence on distance
and none on extinction, directly from \kepler\ light curves.
% Incorporating rotation period measurements into isochrone fitting methods
% provides additional information that allows for much more precise age
% inference.
Gyrochronology, the dating method that uses stellar rotation periods, has the
potential to provide MS star ages that are precise to around 20\%
\citep{epstein2014}.
Due to the abundance of rotation periods of MS stars already provided by
\kepler/\ktwo\ and the many more expected from future photometric surveys,
gyrochronology is one of the most readily available methods for inferring
precise stellar ages and, as such, has gained interest over the last few
years.

%   - How does gyrochronology work?
Magnetic braking in MS stars was first observed by \citet{Skumanich1972} who,
studying young clusters and the Sun, found that the rotation periods of
Solar-type stars decay with the square-root of time.
It has since been established that the rotation period of a star depends, to
first order, only on its age and mass \citep[\eg][]{barnes2003}.
This means that by measuring a star's rotation period and a suitable mass
proxy (B-V color is commonly used), one can determine its age.
The convenient characteristic of stars that allows their ages to be inferred
from their {\it current} rotation periods and independently of their
primordial ones, comes from the steep dependence of spin-down rate on rotation
period \citep{kawaler1989}.
% Observations of young clusters indicate that stellar angular momentum loss
% rate is proportional to the cube of the angular velocity.
This means that a star spinning with high angular velocity will experience a
much greater angular momentum loss rate than a slowly spinning star.
For this reason, no matter the initial rotation period of a Sun-like star,
after around 500 million years stellar rotation periods appear to converge
onto a tight sequence \racomment{citation}.
After this time, the age of a star can be inferred, to first order, from its
mass and rotation period alone; this is the principle behind gyrochronology.

% % Explain the project (add more detail here.)
% In this work we present and test a new age-dating model that combines stellar
% evolution models with an empirical gyrochronology model in a Bayesian
% framework.
% This approach has an advantage over either isochrone fitting or gyrochronology
% alone since the addition of age-relevant information will always improve
% stellar age estimates, unless the models are wrong.

%   - Theoretical vs empirical gyro models
The relation between age, rotation period and mass has been studied in detail
\racomment{CITATIONS}, and several different models have been developed to
capture the rotational evolution of Sun-like stars.
Some of these models are theoretical and based on physical processes; modeling
angular momentum loss as a function of the stellar properties as well as the
properties of the magnetic field and stellar wind.
Other models are empirical and capture the behavior of stars from a purely
observational standpoint, using simple functional forms that can reproduce the
data.
Both types of model; theoretical and empirical, must be calibrated using
observations.
Even the theoretical models are highly sensitive to some stellar properties
that are not measurable: mass-loss rate and magnetic field geometry, for
example.
However, despite significant advances in both types of model,
% theoretical models of stellar spin-down as well as new calibrations of
% empirical models,
the gyrochronology relations have not yet been finalized for two main reasons.
Firstly, the rotational evolution of stars is complex and not well understood.
It is difficult to reproduce the trends in the data using the known physical
processes acting within stellar interiors, surfaces and winds.
It is also challenging to come up with an empirical model that is flexible
enough to capture trends in the data.
Secondly, there is a lack of suitable calibration stars with precisely
measured ages, particularly at old ages.  % and low masses.
% These regions of parameter space are especially important because some
% evidence suggests that rotational evolution goes through a transition at old
% ages and low masses.
% This region of parameter space is especially important because new evidence
% This region of parameter space is
Old calibrators are especially important because new evidence suggests that
rotational evolution goes through a transition at old age or, more
specifically, at a large Rossby number, $Ro$ (the ratio of rotation period to
the convective overturn timescale).
For example, old \kepler\ asteroseismic stars rotate more rapidly than
expected given their age \citep[\eg][]{angus2015, vansaders2016}.
A new physically motivated gyrochronology model, capable of reproducing these
data, was recently introduced \citep{vansaders2016}.
It relaxes magnetic breaking at a critical Rossby number of around the Solar
value, 2.1.
This model predicts that, after stellar rotation periods lengthen enough to
move stars cross this $Ro$ threshold, stars stop spinning down and maintain a
constant rotation period from then until they evolve off the MS.
The implication is that the ages of stars with $Ro >$ 2.1 cannot be measured
from their rotation periods.

%   - Motivation for improvements to gyrochronology relations
Despite recent advances in rotation-dating, such as the new $Ro$ transition
models \citep{vansaders2016}, there is substantial room for
improvement in the gyrochronology relations.
For example, there is, as yet no {\it fully} empirical gyrochronology model
that includes a weakened magnetic braking law after the $Ro$ = 2.1 transition.
Empirical models have value as they are often more flexible than physical
models and can capture trends in the data before the physical processes at
work are fully understood.
In addition, no single gyrochronology relation can reproduce the rotational
behaviour of all open clusters; the relation between rotation period, age and
mass varies from cluster to cluster in a way that cannot be captured by
any current model.
Again, this is related to the issue of model flexibility.
Finally, more stars with precisely measured old ages are needed to confidently
calibrate gyrochronology models at old ages.
New asteroseismic calibrators will become available from reprocessed \kepler\
short cadence light curves, however significant numbers of suitable
gyrochronology calibrators may not be accessible until after the European
Space Agency's \plato\ mission is launched.

%   - Describe the project presented here.
The gyrochronology models that capture post $Ro$-threshold, rotational
evolution \citep{vansaders2016} are the current state-of-the-art in rotation
dating.
% developed and calibrated in \citet{epstein2014, vansaders2015,
% vansaders2016, vansaders2018} However, despite their superior accuracy, they
These models are expensive to compute and, just as with most isochrones and
stellar evolution tracks, are usually pre-computed over a grid of stellar
parameters in order to perform computionally tractable inference.
Inferring ages using these models is similar to inferring an age using any set
of isochrones, with the main difference being that rotation period is an
additional dimension.
Ages calculated using these models are therefore likely to be more precise
than using rotation-free isochrones since rotation period provides an
additional anchor-point for the age of a star.
% In order to infer an age from these models, one would effectively perform
% isochrone fitting but in this case, rotation period would be added as an
% additional parameter and the ages inferred would therefore be more precise and
% accurate.
We present here a complementary method that combines isochrones with an {\it
empirical} gyrochronology model using a Bayesian framework.
The methodology is related to the models described above \citep{vansaders2016}
in that both use a combination of rotation periods and other observable
properties that track stellar evolution on the HR diagram in concert.
The main difference is that the gyrochronology model used here is an entirely
empirically calibrated one, as opposed to a physically derived one.
One major advantage of using a physically motivated gyrochronology model over
an empirically calibrated one is the ability to rely on physics to interpolate
or extrapolate over parts of parameter space with sparse data coverage.
However, rotational spin-down is a complex process that is not yet fully
understood and currently no physical model can accurately reproduce all the
data available.
For this reason, even physically motivated gyrochronology models cannot always
be used to reliably extrapolate into unexplored parameter space.
Physical models, when calibrated to data can provide insight into the physics
of stars however, if accurate and precise {\it prediction} of stellar
properties is desired, empirical models can have advantages over physical
ones.
For example, the data may reveal complex trends that cannot be reproduced with
our current understanding of the physical processes involved but may be
captured by more flexible data-driven models.
In addition, it is relatively straightforward to build an element of
stochasticity into empirical models, \ie\ to allow for and incorporate
outliers or noisy trends.
This may be particularly important for stellar spin down, which does not
always seem to behave predictably.
% For example, synchronized binaries often appear to be rapidly rotating single
% stars which do not fall on the gyrochronology sequence and are perhaps one of
% the most common cause of outliers.
% One can never be certain that the rotation period of any given star truly
% reflects its age: there is a chance that it is an outlier.
% The probability that a star is an outlier in rotation-color-age space can be
% modeled and incorporated easily into an empirical gyrochronology model.
% In a deterministic model, a star with a rotation period that misrepresents its
% age will have a precise but extremely inaccurate inferred age.
% If however, some allowance for outliers or instrinsic scatter is built into
% the models, such a star would be recognized as an outlier and would have a
% very imprecise but accurate inferred age.
% The relation between rotation period and age for M dwarfs is noisy, and a
% deterministic model would not be appropriate for these stars: it would lead to
% inaccurately predicted ages with over-optimistic precision.
% Instead, these data could be appropriately modeled with a stochastic mixture
% of broad Gaussians, or similar.
A further advantage of empirical models is that it can be extremely fast to
fit them to data.
We use a simple, deterministic gyrochronology model in this work, which, like
any other gyrochronology model, cannot yet reproduce all the observed data.
However, simple modifications could be made to this model to produce
significant improvements, for example, by including instrinsic scatter and
outliers.
We leave these improvements for a future project.
% For example, an allowance for outliers; stars with anomalously fast or slow
% rotation periods, could be build into our model.
Ultimately, the model we present here will provide a baseline against which
more physically motivated models can be compared.

% % Inconsistency and inaccuracy of models
% In addition to the difficulties imposed by the slow timescale for change
% within MS stars that results in poor age precision, different dating methods
% often produce inconsistent predictions for the age of a star as a result of
% model inaccuracies.
% For example, an asteroseismic age will not necessarily agree with a isochronal
% one and even isochronal ages derived from different stellar evolution models
% can be inconsistent.
% % physics driving models are wrong.
% % Not enough calibration data.
% This problem arises from a lack of calibrators with sufficiently precise
% stellar properties.

% Bayesian isochrone fitting.
% This section should contain more background about the poor uncertainties
% expected when a purely isochrone fitting technique is used.

% Sum up.
%-----------------------------------------------------------------------------
% There is still some way to go before the models we use to age-date
% MS stars produce precise and accurate ages.
% This paper presents an incremental step toward improving age-dating models and
% best-practises.
% It also provides a discussion on the balance between accuracy and precision
% within age-dating models.

% Paper outline
%-----------------------------------------------------------------------------
This paper is laid out as follows.
In section \ref{section:method} we describe our new age-dating model and its
implementation, in section \ref{section:results} we test this model on
simulated stars, cluster stars and asteroseismic stars, and in section
\ref{section:discussion} we discuss the implications of these tests and future
pathways for development.
Throughout this paper we use the word {\it `observables'} to describe the set
of \teff, \logg, observed bulk metallicity, parallax, photometric color and
rotation period observations for a given star.
We use the word {\it `parameters'} to refer to the physical properties of that
star: age, mass, true bulk metallicity, distance and V-band extinction that
{\it generate} the observables.
