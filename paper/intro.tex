\section{Introduction}
\label{section:intro}

%   - The need for better stellar ages.
The formation and evolution of the Milky Way and the planetary systems within
it are two topics of significant interest in astronomy today.
Both of these fields require precise and accurate ages for tens to hundreds of
thousands of stars, however, age is the most difficult stellar property to
measure.
The difficulty of age-dating is particularly acute for low mass (GKM) stars on
the MS, precisely those that comprise the majority of known planet hosts.
Using conventional dating methods, uncertainties on the ages of these stars
can be as large as the age of the Universe.
The stars eligible for {\it truly} precise age-dating, where age uncertainties
can be as low as 10\%, are those in nearby open clusters, those with
observable acoustic oscillations (asteroseismic stars), those just turning off
the MS, and the Sun
\citep[see][for a review of stellar ages]{soderblom2010}.
There are only a few tens of cool, MS stars with precise ages that are
suitable for exoplanet population studies, however {\it tens-of-thousands} of
precise ages are needed to study the evolution of planetary systems
\citep[\eg][]{petigura2013, foreman-mackey2014, veras2015, burke2015}.
The number of planets detected in open clusters, and therefore with precise
ages, is growing \citep[\eg][]{mann2017, rizzuto2018, vanderburg2018,
mann2018}, however there are still only a couple of dozen of these discovered
so far and the total number of detectable planets in clusters is unlikely to
reach statistical numbers in the near future.
In order to study the evolution of planetary systems, a significant number of
precise ages for cool MS {\it field} stars are needed.
% Neither cluster stars nor asteroseismic stars can currently provide the
% numbers required for exoplanet population studies: age-dating methods for cool
% MS field stars {\it must} be improved before the evolution of planets can be
% explored.

%   - Why are MS ages harder than red giant ages?
The ages of GKM dwarfs are difficult to measure because their spectra and
colors of MS stars do not change rapidly.
This is represented in the spacing of isochrones on a Hertzsprung-Russell (HR)
or color-magnitude diagram (CMD).
On the MS, isochrones are tightly spaced and, even with very precise
measurements of effective temperature and luminosity, the position of a MS
star on the HR diagram may be consistent with range of isochrones spanning
several billion years.
At main sequence turn-off however, isochrones are spread further apart, so
that sufficiently precisely measured temperatures and luminosities can yield
ages that are extremely precise.
% Typical age uncertainties of dwarfs.
The classical method for measuring stellar ages is isochrone placement, or
isochrone fitting, where surface gravity changes resulting from fusion in the
core (usually observed via luminosity, $L$, and effective temperature, \teff,
or absolute magnitude and colour) are compared with a set of models that trace
stellar evolution across the HR diagram, or CMD.
Surface gravity changes have been thoroughly mapped with physical models, and
can be used to calculate relatively accurate, but not necessarily precise,
ages, barring some small, $\sim$10\% variations between different models
\citep[\eg][]{yi2001, dotter2008, dotter2016}.
Isochronal ages {\it can} be precise for stars turning off the MS, because the
rate of change in brightness and temperature is large during this phase of
stellar evolution.
However, on the MS itself, there is little differentiation between stars of
different ages in the $L$ and \teff\ plane, so ages tend to be very imprecise.
The method of inferring a star's age from its rotation period, called
`gyrochronology', is much better suited for measuring ages on the MS because
MS, stars spin down relatively rapidly.

%   - How does gyrochronology work?
Magnetic braking in MS stars was first observed by \citet{skumanich1972} who,
studying young clusters and the Sun, found that the rotation periods of
Solar-type stars decay with the square-root of time.
It has since been established that the rotation period of a star depends, to
first order, only on its age and mass \citep[\eg][]{barnes2003}.
This means that by measuring a star's rotation period and a suitable mass
proxy (B-V color is commonly used), one can determine its age.
The convenient characteristic of stars that allows their ages to be inferred
from their {\it current} rotation periods and independently of their
primordial ones, comes from the steep dependence of spin-down rate on rotation
period \citep{kawaler1989}.
This means that a star spinning with high angular velocity will experience a
much greater angular momentum loss rate than a slowly spinning star.
For this reason, no matter the initial rotation period of a Sun-like star,
after around the age of the Hyades (500-700 million years) stellar rotation
periods appear to converge onto a tight sequence \citep{irwin2009}.
After this time, the age of a star can be inferred, to first order, from its
mass and rotation period alone and this is the principle behind gyrochronology.

%   - Theoretical vs empirical gyro models
The relation between age, rotation period and mass has been studied in detail,
and several different models have been developed to capture the rotational
evolution of Sun-like stars.
Some of these models are theoretical and based on physical processes; modeling
angular momentum loss as a function of stellar properties as well as the
properties of the magnetic field and stellar wind \citep{kawaler1988,
kawaler1989, vansaders2013, matt2015, vansaders2016}.
Other models are empirical and capture the behavior of stars from a purely
observational standpoint, using simple functional forms that can reproduce the
data \citep{barnes2003, barnes2007, mamajek2008, angus2015}.
Both types of model, theoretical and empirical, must be calibrated using
observations.
Old calibrators are especially important because new evidence suggests that
rotational evolution goes through a transition at old age or, more
specifically, at a large Rossby number, $Ro$ (the ratio of rotation period to
the convective overturn timescale).
For example, old \kepler\ asteroseismic stars rotate more rapidly than
expected given their age \citep[\eg][]{angus2015, vansaders2016}.
A new physically motivated gyrochronology model, capable of reproducing these
data, was recently introduced \citep{vansaders2016}.
It relaxes magnetic breaking at a critical Rossby number of around 2,
approximately the Solar value.
This model predicts that, after stellar rotation periods lengthen enough to
move stars cross this $Ro$ threshold, stars stop spinning down and maintain a
constant rotation period from then until they evolve off the MS.
The implication is that the ages of stars with $Ro >$ 2.1 cannot be measured
from their rotation periods.

%   - Describe the project presented here.
The gyrochronology models that capture post $Ro$-threshold, rotational
evolution \citep{vansaders2016} are the current state-of-the-art in rotation
dating.
These models are expensive to compute and, just as with most isochrones and
stellar evolution tracks, are usually pre-computed over a grid of stellar
parameters, then interpolation is used to predict the age of a star.
The process of measuring a stellar age with these models is similar to
inferring an age using any set of isochrones, with the main difference being
that rotation period is an additional dimension.
Ages calculated using these models are therefore likely to be much more
precise than using rotation-free isochrones since rotation period provides an
additional anchor-point for the age of a star.
We present here a complementary method that combines isochrones with an {\it
empirical} gyrochronology model using a Bayesian framework.
The methodology is related to the models described above \citep{vansaders2016}
in that both use a combination of rotation periods and other observable
properties that track stellar evolution on the HR diagram in concert.
The main difference is that the gyrochronology model used here is an entirely
empirically calibrated one, as opposed to a physically derived one.
One major advantage of using a physically motivated gyrochronology model over
an empirically calibrated one is the ability to rely on physics to interpolate
or extrapolate over parts of parameter space with sparse data coverage.
However, rotational spin-down is a complex process that is not yet fully
understood and currently no physical model can accurately reproduce all the
data available.
For this reason, even physically motivated gyrochronology models cannot always
be used to reliably extrapolate into unexplored parameter space.
Physical models, when calibrated to data. can provide insight into the physics
of stars however, if accurate and precise {\it prediction} of stellar
properties is desired, empirical models can have advantages over physical
ones.
For example, the data may reveal complex trends that cannot be reproduced with
our current understanding of the physical processes involved but may be
captured by more flexible data-driven models.
In addition, it is relatively straightforward to build an element of
stochasticity into empirical models, \ie\ to allow for and incorporate
outliers or noisy trends.
This may be particularly important for stellar spin down, which does not
always seem to behave predictably.
A further advantage of empirical models is that inference is more tractable:
it can be extremely fast to fit them to data.
We use a simple, empirical, deterministic gyrochronology model in this work,
which, like any other gyrochronology model, cannot yet reproduce all the
observed data.
Simple modifications could be made to this model to produce significant
improvements, for example, by including a mixture model to account for
outliers and binaries, however we leave these improvements for a future
project.
Ultimately, the model we present here will provide a baseline against which
other gyrochronology models can be compared.
We also provide a new gyrochoronology {\it Python} package, the first of its
kind, which accompanies this paper.

% Motivation
There are several reasons why combining isochrone fitting with gyrochronology
is more powerful than using either method in isolation.
Firstly, the two methods are optimal in different parts of the HR diagram:
gyrochronology works well for FGK dwarfs and isochrone fitting works well for
subgiants and hot stars, so combining the two methods results in consistently
precise ages across a range of masses, ages and evolutionary stages.
Secondly, using both methods at once circumvents the need to decide which
method to use {\it a priori}.
It eliminates the circular process of classifying a star based on its CMD
position (M dwarf, subgiant, etc), then deciding which age-dating method to
use, then inferring an age which itself depends on the classification that was
made.
It is important to infer all stellar properties at once since they all depend
on each other.
Thirdly, including a rotation period measurement can actually improve mass and
metallicity estimates since these properties depend on stellar age.

% Paper outline
%-----------------------------------------------------------------------------
This paper is laid out as follows.
% In section \ref{section:motivation} we provide additional motivation for
% combining gyrochronology and isochrone fitting by providing examples based
% on information theory.
In section \ref{section:method} we describe our new age-dating model and its
implementation, in section \ref{section:results} we test this model on
simulated stars and cluster stars, and in section \ref{section:discussion} we
discuss the implications of these tests and future pathways for development.
Throughout this paper we use the term {\it `observables'} to refer to the
following observed properties of a star, \teff, \logg, observed bulk
metallicity ($[\hat{F}]$), parallax ($\bar{\omega}$), photometric
colors in different passbands (${\bf m_x} = [m_J, m_H, m_K, m_B, m_V, m_G,
...]$, etc) and rotation period
($P_{\mathrm{rot}}$).
The term {\it `parameters'} refers to the physical properties of that star:
age ($A$), mass ($M$), true bulk metallicity ($F$), distance ($D$) and V-band
extinction ($A_V$).
These are the properties that generate the observables.
% Equivalent evolutionary point is a proxy for the evolutionary stage of a star,
% that is computed as part of the MIST isochrone library.
% Mass can be exactly determined from \eep, age and metallicity.
