\section{Conclusions}
\label{section:conclusion}

We present a statistical framework for measuring precise ages of MS stars and
subgiants by combining observables that relate, via different evolutionary
processes, to stellar age.
Specifically, we combined HRD/CMD placement with rotation periods, in a
hierarchical Bayesian model, to age-date stars based on both their hydrogen
burning and magnetic braking history.
The two methods of isochrone fitting and gyrochronology were combined by
taking the product of two likelihoods: one that contains an isochronal model
and the other a gyrochronal one.
We used the MIST stellar evolution models and computed isochronal ages and
likelihoods using the {\tt isochrones} {\it Python} package.
We fit a new broken power law gyrochronology model to the Praesepe cluster
and included a modification recommended by \citet{vansaders2016} that accounts
for weakened magnetic braking at Rossby numbers larger than 2.
The rotation periods of hot stars, cool stars, evolved stars, young stars and
extremely metal poor and rich stars were modeled with a broad log-normal
distribution.
We tested \sd\ on simulated data and cluster stars and demonstrated that
combining gyrochronology with isochrone fitting improves the precision of age
estimates for FGK dwarfs by a factor of 3 over isochrone fitting alone,
assuming 5\% measurement uncertainties on rotation periods.
Incorporating rotation periods into stellar evolution models also improves the
precision of the equivalent evolutionary phase (EEP) parameter and, since EEP,
combined with age and metallicity, determines the mass, radius and \logg\ of a
star, this means rotation periods can improve the precision of {\it all}
stellar parameters.
Although V-band extinction is marginalized over during inference, correcting
photometry for dust-extinction {\it before} analysis, or including it as a
prior can improve the accuracy of stellar ages measured with \sd.

\sd\ may predict inaccurate ages for stars in close binaries whose
interactions influence their rotation period evolution.
Rotational outliers are often seen in clusters \citep[see \eg][]{douglas2016,
rebull2016, douglas2017, rebull2017} and many of these fall above the main
sequence on a CMD, indicating that they are binaries.
In addition, measured rotation periods may not always be accurate and can, in
many cases, be a harmonic of the true rotation period.
For example, a common rotation period measurement failure mode is to measure
half the true rotation period.
The best way to prevent an erroneous or outlying rotation period from
resulting in an erroneous age measurement is to {\it allow} for outlying
rotation periods using a mixture model, and we intend to build a mixture model
into \sd\ in future.

% Motivation
The optimal way to age-date stars is by combining {\it all} their available
age-related observables.
This could ultimately include activity dating via flare rates and
chromospheric activity indices, kinematic dating and chemical dating.
Of all the established age-dating methods, gyrochronology and isochrone
fitting are two of the most complementary.
The two methods are optimal in different parts of the HRD:
gyrochronology works well for FGK dwarfs and isochrone fitting works well for
subgiants and hot stars, so combining the two methods results in consistently
precise ages across a range of masses, ages and evolutionary stages.
In addition, using both methods at once circumvents the need to decide which
method to use {\it a priori}.
It eliminates the circular process of classifying a star based on its CMD
position (M dwarf, subgiant, etc), then deciding which age-dating method to
use, then inferring an age which itself depends on the classification that was
made.
It is important to infer all stellar properties at once since they all depend
on each other.
\sd\ is applicable to a large number of stars: FGKM dwarfs and subgiants with
a rotation period and broad-band photometry.
This already includes tens-of-thousands of \kepler\ and \ktwo\ stars and could
include millions more from \tess, \lsst, \wfirst, \plato, \gaia, and others in
future.

The code used in this project is available as a {\it Python} package called
\sd, DOI: \url{ https://doi.org/10.5281/zenodo.2712419}.
It is available for download via Github\footnote{git clone
https://github.com/RuthAngus/stardate.git} or through
PyPI\footnote{pip install stardate\_code}.
Documentation is available at \url{https://stardate.readthedocs.io/en/latest/}.
All code used to produce the figures in this paper is available at
\url{https://github.com/RuthAngus/stardate}.
This paper is based on code with the following Git hash:
f739562c1546e117e9bb217e1732c62b41be8061.
% git log --pretty=format:'%H' -n 1
% git log --pretty=format:'%h' -n 1
